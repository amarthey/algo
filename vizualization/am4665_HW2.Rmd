---
title: "Homework 2"
output:
  html_notebook: default
  html_document: default
---
Name: Antoine Marthey

UNI: am4665

#  PART A

#  Chapter 4 - Exercice 5

 * Question 4-5-A
 
```{r}
library(vcdExtra)
library(ggplot2)
library(tidyr)
data_yama <- data.frame(Yamaguchi87)
ggplot(data_yama, aes(x = data_yama$Son, y = data_yama$Freq,fill=data_yama$Country)) +
    geom_bar(stat='identity',position="dodge") + xlab("Occupations") + ylab("Value") + ggtitle("Distribution of occupations of the sons") + theme(plot.title = element_text(hjust = 0.5))
```
For the UK and the US, the Lower Manual are the most common. The sons are less likely to be farmers. 

At the opposite, for Japan, we are more likely to find a farmer in the younger population. At the opposite of the UK and the US, there is a low number of sons that are doing Upper Non Manual work.

 * Question 4-5-B

```{r}
library(gridExtra)
son <- aggregate(list(Freq = Yamaguchi87$Freq), by=list(Country=Yamaguchi87$Country, Son = Yamaguchi87$Son), FUN=sum) 
new_son <- spread(son, Country, Freq) 
sons <- ggplot(new_son, aes(Son)) + geom_bar(aes(y=new_son$UK), stat="identity",color=1, fill =4) + xlab("Son") + ylab("Value") + ggtitle("Distribution of occupations of the Sons in the UK") + theme(plot.title = element_text(hjust = 0.5))
father <- aggregate(list(Freq = Yamaguchi87$Freq), by=list(Country=Yamaguchi87$Country, Father = Yamaguchi87$Father), FUN=sum) 
new_father <- spread(father, Country, Freq)
fathers <- ggplot(new_father, aes(Father)) + geom_bar(aes(y=new_father$UK), stat="identity", color=1, fill =3) + xlab("Father") + ylab("Value") + ggtitle("Distribution of occupations of the Fathers in the UK") + theme(plot.title = element_text(hjust = 0.5))
grid.arrange(sons, fathers)
```
Father's distribution seems to have a pic for Lower Manuel jobs.
Sons's distribution is more spread out with a maximum jobs for Lower Manuel and very few Farmers.

 * Question 4-5-C

There was a lot more Lower Manuel job in the past (father's distribution).
It is today more spread out between all type of jobs.

This is no big surprise.

#  Chapter 4 - Exercice 6

 * Question 4-6-A

```{r}
whis <- data.frame(Scotch, stringsAsFactors=F)    
whis["Total" ,] <- colSums(whis)
whis_transpose <- t(whis)
whis_transpose <- data.frame(whis_transpose)
Names_Whisky <- rownames(whis_transpose)
whis_2 <- cbind(whis_transpose,Names_Whisky)
whis_2 <- data.frame(whis_2)
ggplot(whis_2, aes(x = reorder(Names_Whisky,whis_2$Total), y = whis_2$Total)) +
    geom_bar(stat='identity',fill = "blue", colour = "blue",alpha=0.3) + coord_flip() + xlab("Scotch Brands") + ylab("Value") + ggtitle("Distribution of consumption for the previous year") + theme(plot.title = element_text(hjust = 0.5))
```

Ordering of the brand: the highest value to the lowest.

 * Question 4-6-B
 
I would group all the value under 200 in the same "Other" group. I would define a big brand if the Total Score is higher than 200.

 * Question 4-6-C

We could use color to differentiate the type of alcool and facet_wrap per "bottled".
We could hence represent 4 dimensions.
4 dimensions : brands, value, type and bottled.

 * Question 4-6-D
 
No difference in the data set. 
I would pick Whisky without a e, because the data comes from Scotch !!

#  Chapter 5 - Exercice 8

 * Question 5-8-A
 
```{r}
library(extracat)
library(GGally)
library(extracat)
contcols =  colnames(olives)[3:10]
pairs(olives[contcols])
```

Strongly positively associated: (palmitic, palmitoleic), 
Strongly negatively associated: (palmitic, oleic), (palmitoleic, oleic), (oleic, linoleic)

Questionable association: (linolenic, eicosenoic), (arachidic, eicosenoic)

 * Question 5-8-B

```{r}
library(ggplot2)
tidyolives = olives[c(contcols, 'Region')] %>% gather(key, value, -Region)
ggplot(tidyolives, aes(x=key, y=value)) +
 geom_boxplot() + 
 facet_wrap(~key, scales = "free")
```

There are outliers on 4 variables: Arachidic, linolenic, palmitic & stearic.

#  Chapter 5 - Exercice 10

 * Question 5-10-A
 
```{r}
library(knitr)
knitr::include_graphics('/Users/antoinemarthey/Desktop/File/hrdiagram_01.jpg')
```
```{r}
library(GDAdata)
library(ggplot2)
star <- data.frame(HRstars)
ggplot(star, aes(x = BV, y = V)) +
  geom_point()
```
The difference with google images: Not scale the same way. Horizontal axis are not oriented the same way, Google Images is decreasing, mine is augmenting.

 * Question 5-10-B
 
There seem to be less data points on the Google Image. Maybe if the uncertainty is not higher than a certain value (for exemple, 100) the data was filtered out.

 * Question 5-10-C

We could color the data points per temperature (temperature being as well the x-axis).
We could also change the data point size (scalling) to represent another dimension.

#  Chapter 6 - Exercice 5

 * Question 6-5-A
 
```{r}
library(ggplot2)
library(lawstat)
library(dplyr)
library(GGally)
library(parcoords)
body_fat <- data.frame(bodyfat)
parcoords(body_fat
         ,rownames = F 
         ,brushMode = "1D-axes"
         ,reorderable = T
         ,queue = T
         ,color = list(colorBy = "Region" ,colorScale = htmlwidgets::JS("d3.scale.category10()")))
```
There seems to be some outliers depending on each variable. But the graph is really dense so it is tough to identify specific outliers.

```{r}
ggparcoord(data=body_fat,
           columns = 6:15,
           groupColumn = 2,
           scale = 'globalminmax',
           shadeBox = NULL,
           alphaLines = 0.5,
           title = "Parallel coordinates for differents measurements") +
           theme(plot.title = element_text(hjust = 0.5))
```
For a none-scale pcp, we can identify 2 outliers of the graph.

 * Question 6-5-B
 
```{r}
height <- body_fat$height
base_1 <- ggplot(body_fat, aes(x = "height", y = height))
base_1 + geom_boxplot()
```
```{r}
base_2 <- ggplot(body_fat, aes(height))
base_2 + geom_density()
```
Height seems to be normally distributed around the mean 69.5
It looks like there is no outliers for this variable.

 * Question 6-5-C
 
They are inversely corrolated. If your bodyfat is high then your density is low. The inverse is true as well.

 * Question 6-5-D
 
It might be sensible. I think we should move all the variable that don't matter to the end of the graph. Then maybe we can order the variable from the top of the body to the bottom. 
Physical information should be next to each other. Informative (ie age, bodyfat,...) should be grouped together as well.

#  Chapter 6 - Exercice 7

 * Question 6-7-A
 
```{r}
library(gclus)
library(pgmm)
library(GGally)
winedata <- data.frame(wine, package = "pgmm")
parcoords(winedata
         ,rownames = F 
         ,brushMode = "1D-axes"
         ,reorderable = T
         ,queue = T
         ,color = list(colorBy = "Type" ,colorScale = htmlwidgets::JS("d3.scale.category10()"))) 
```

Type 1 and 3 seem to have a pattern in their behavior. 
At the opposite type 2 seems to be spread data with a lot of noise.

 * Question 6-7-B

```{r}
library(tidyr)
tidywine <- wine %>% gather(key, value, -Type)
tidywine2 <- tidywine %>% filter(!key %in% c('Magnesium', 'Proline'))
ggplot(tidywine2, aes(x=key, y=value)) +
 geom_boxplot() +
 labs(x='', y='Value') + coord_flip()
```
We can see that on almost all the variable we have outliers.
 
 * Question 6-7-C

It seems that for some of the variables, there is always the same behavior. They are all merging to a common point. 

For other variables, the data seem spread.

#  PART 2

 * First data analysis
 
```{r}
yama.indep <- glm(Freq ~ Son + Father + Country, data=Yamaguchi87)
mosaic(yama.indep, ~Son+Father, main="Correlation Son/Father occupations in the UK")
```

Using a Poisson Distribution for the data, we get:

```{r}
yama.indep_1 <- glm(Freq ~ Son + Father + Country, data=Yamaguchi87,family=poisson)
mosaic(yama.indep_1, ~Son+Father, main="Correlation Son/Father occupations in the UK")
```
I choose to look at the Father/Son occupation dataset and the correlation between the data.
We can see from the data that there is a huge correlation between the fathers' jobs and the sons' jobs. If your dad was a farmer, you are more likely to be a farmer (blue boxes). At the opposite, if your dad was a farmer, you are not likely to be a Upper Non Manuel worker.
p value is very low -> good sign

 * Second data analysis
 
```{r}
library(GDAdata)
library(ggplot2)
star <- data.frame(HRstars)


uncer = c(0, 75, 200)
uncerlabel = c('First', 'Second', 'Third')

uncerint = findInterval(HRstars$Uncert, uncer)
HRstars$uncergroup = factor(uncerint, levels=c(1, 2, 3), labels=uncerlabel)
ggplot(star, aes(x = BV, y = V, color=uncergroup)) + scale_x_reverse() +
  geom_point()
```
```{r}
uncerint = findInterval(HRstars$Uncert, uncer)
HRstars$uncergroup = factor(uncerint, levels=c(1, 2, 3), labels=uncerlabel)
final_HR <- filter(HRstars, uncergroup == "First")
ggplot(final_HR, aes(x = BV, y = V, color=uncergroup)) + scale_x_reverse() +
  geom_point()
```

My second analysis is going through the star data (Hertzsprung-Russell). I wanted to focus on the star that have a degree of uncertainty as low as possible, in order to analysis their distribution. My initial idea was to understand how Google (and behind it, scientists) have come to the final image that we can see on Google Images. So I decided to cluster my data and focus on all the star with a degree of uncertainty below 75. 
Conclusion: It looks similar to the Google's distribution.