---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
#' Homework 1 - am4665
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file).

```{r}
library(knitr)
knitr::include_graphics('/Users/antoinemarthey/Desktop/File/Fox_welfare-jobs-ff-1.jpg')

# source: http://www.statisticshowto.com/misleading-graphs/

#' Graph that I don't like
#' I selected a graph from Fox news which I totally misleading
#' First, we are not sure what is the time period that has been selected. Is that an average on the last 5 years? Is that an average on 2011? Is that a specific day during 2011? Source needs to be more detailed
#' Second the y axis does not start at 0, which creates a lot of confusion. It seems at first look that the people on welfare are 4 times more important than the people with a full time job. It is actually only 51% of the sample.
```
```{r}
knitr::include_graphics('/Users/antoinemarthey/Desktop/File/life_expectancy.gif')

# source: http://www.ats.ucla.edu/stat/stata/library/GraphExamples/code/line4.htm

#' Graph that I like
#' I selected a graph about the difference between life expentancy between 2 groups of people
#' First, the graph presents a huge collection of data, from 1900 to 2000. It means that the study has been long enough to collect enough data and so be trustful.
#' Second the x and y axes are clearly labels and understandable. We can also look at 4 differents type of data on the same graph. 
#' Finally colors are helpful to differentiate the variables.
```


```{r}
library(MASS)
galaxies
layout(matrix(c(2,1,3,3), 2, 2, byrow = FALSE))
hist(galaxies)
plot(density(galaxies))
boxplot(galaxies)

# Question 1-A

# We can see from the 3 graphs that the data are really spread. The min and max are far from the median. We can see from the 3 graphs that a lot of the data seem to be between 150000 and 25000 but the histogram breaks are to important, i.e 5000. We can refine the spread from the boxplot and the density function. 
```
```{r}
galaxies
par(mfrow=c(2,1)) 
hist(galaxies,breaks=50)
plot(density(galaxies,adjust=0.4))

# Question 1-B

# By refining the parameters of hist (breaks=50) and density (adjust=0.5) we can get two similars curves. We can also see that the bumps at the extremity of the graph are taken into account.
```

```{r}

# Question 3-A

library("ggplot2")
df <- data.frame(survey)

ggplot(df, aes(df$Height)) + 
 geom_histogram(aes(y =..density..),col=1) +
 geom_density(col=2)

# There is no clear evidence of binomality. The curve doesn't look perfectly symetric.
```

```{r}

# Question 3-A

library("ggplot2")
df <- data.frame(survey)

ggplot(df, aes(df$Height)) + 
 geom_histogram(aes(y =..density..), binwidth = 2,col=1) +
 geom_density(adjust=0.3, col=2)

# binwidth = 2 and adjust = 0.3 look to fit the same distribution.
```


```{r}

# Question 3 - C 

survey
df <- data.frame(survey)
df <- subset(df,!is.na(Sex))

ggplot(df, aes(x = Height, color = Sex)) + 
  geom_histogram(aes(y =..density..),color=1, binwidth = 1) +
  geom_density(adjust=2) +
  facet_wrap(~Sex)

```

```{r}
ggplot(df, aes(x = Height, color = Sex)) + 
  geom_histogram(aes(y =..density..),color=1, binwidth = 1) +
  geom_density(adjust=2)
```


```{r}
library(lawstat)
library(dplyr)
data(zuni)
zuni
str(zuni)
summary(zuni)
df <- data.frame(zuni)

ggplot(df, aes(x= Revenue, y= Mem)) +
  geom_point()
```

```{r}
ggplot(df, aes(x = Revenue)) + 
  geom_histogram(aes(y =..density..),col=1,binwidth = 50)
```

```{r}
ggplot(df, aes(x = Revenue, y = Mem)) + 
  geom_boxplot()

#' Both histogram and boxplot have assets and drawbacks.
# Histogram is better to identify the top values and the lowest values. But identifying exactly 5% is difficult
# With boxplot, we can easily identify the highest 5% but it is hard to identify the lowest 5%.

```

```{r}
quantile(zuni$Revenue, 0.95)
zuni_5_95 <- zuni[(quantile(zuni$Revenue, 0.05) < zuni$Revenue) & (zuni$Revenue < quantile(zuni$Revenue, 0.95)), ]

ggplot(data=zuni_5_95, aes(zuni_5_95$Revenue)) + 
  geom_histogram(aes(y =..density..), col=1, binwidth=30) +
  geom_density(col=2, adjust=1)

# The foloowing distribution does not look symetric from the paramter we selected. The pic look centered on the left side of the graph and not in the middle. High value data make the graph not symetric.
```

```{r}
qqnorm(zuni_5_95$Revenue)
qqline(zuni_5_95$Revenue)

# the distribution is not normally distributed because of the highest and lowest value of the sample. If the sample was smaller, i.e the value in the middle of the graph, then the distribution would be normally distributed.

```

```{r}
library(MASS)
library(ggplot2)
require(GGally)
Names <- rownames(painters)
new_painters <- cbind(painters,Names)
ggparcoord(data=new_painters,
           columns = 1:4,
           groupColumn = 5,
           scale = 'globalminmax',
           shadeBox = NULL,
           alphaLines = 0.5,
           title = "Parallel coordinates - Score for each painter") #+ facet_wrap(~painters$School)

# I try to gather in one graph the 5 differents type of information of the data table.

# Assets of the graph: 
#   - We can easily figure out his certain class of painters are more likely to be good in certain aspects. We can see if there is a trend in the data. For exemple, School D of painters are great at using colors. School A hqs a very sparse level in composition.

# Drawbacks of the graph:
#  - Unfortunately the color are hard to distinguish. Since they are 54 entries, it makes the graph are to read.
```

```{r}
library(reshape2)
data_painters <- painters
data_painters$School <- NULL
data_painters <- cbind(data_painters,Names)
dat.m <- melt(data_painters,id.vars = "Names") ## just melt(dat) should work
ggplot(dat.m, aes(x = Names, y = value,fill=variable)) +
    geom_bar(stat='identity')
```

```{r}
dat.m <- melt(painters,id.vars = "School") ## just melt(dat) should work
ggplot(dat.m, aes(x = School, y = value,fill=variable)) +
    geom_bar(stat='identity')
```

